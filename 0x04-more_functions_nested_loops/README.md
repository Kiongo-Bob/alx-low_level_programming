Addditional functions and nested loops
